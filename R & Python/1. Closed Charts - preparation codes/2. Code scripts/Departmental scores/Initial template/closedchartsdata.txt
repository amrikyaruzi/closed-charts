library(tidyverse)
library(dplyr)
library(readr)
closedchartsdata <- read_csv("closedchartsdata.csv")
View(closedchartsdata)
dt <- tbl_df(closedchartsdata)
glimpse(dt)

dt %>% group_by(DEPT) %>% count() %>% arrange(desc(n))

##DOA
#DOCUMENTED
DOAPenultimate <- dt %>% filter(SNN == 1.3 | SNN == 4.1 | SNN == 5.1 | SNN== 5.2 | SNN == 5.3 | SNN == 5.4 | SNN == 7.2
) %>% filter(DEPT == "DOA") 
DOA <- select(DOAPenultimate, "DOCUMENTED" : "MET")

DOADFINAL <- mutate(DOA, DOCUMENTEDNUMERIC = ifelse(DOA$DOCUMENTED %in% "D", 1, ifelse(DOA$DOCUMENTED %in% "ND", 1, 0)))
ALLDDOA <- filter(DOADFINAL, DOCUMENTEDNUMERIC == "1")
DOCUMENTEDPenultimateDOA <- filter(ALLDDOA, DOCUMENTEDNUMERIC == "1" & DOCUMENTED == "D")
DOCUMENTEDSCOREDOA <- sum(DOCUMENTEDPenultimateDOA$DOCUMENTEDNUMERIC)
TOTALDSCOREDOA <- sum(ALLDDOA$DOCUMENTEDNUMERIC)
PercentDocumentedDOA <- (DOCUMENTEDSCOREDOA*100)/TOTALDSCOREDOA


#TIMELY
DOATFINAL <- mutate(DOA, TIMELYNUMERIC = ifelse(DOA$TIMELY %in% "Y", 1, ifelse(DOA$TIMELY %in% "N", 1, 0)))
ALLTDOA <- filter(DOATFINAL, TIMELYNUMERIC == "1")
TIMELYPenultimateDOA <- filter(ALLTDOA, TIMELYNUMERIC == "1" & TIMELY == "Y")
TIMELYSCOREDOA <- sum(TIMELYPenultimateDOA$TIMELYNUMERIC)
TOTALTSCOREDOA <- sum(ALLTDOA$TIMELYNUMERIC)
PercentTimelyDOA <- (TIMELYSCOREDOA*100)/TOTALTSCOREDOA


#LEGIBLE
DOALFINAL <- mutate(DOA, LEGIBLENUMERIC = ifelse(DOA$LEGIBLE %in% "Y", 1, ifelse(DOA$LEGIBLE %in% "N", 1, 0)))
ALLLDOA <- filter(DOALFINAL, LEGIBLENUMERIC == "1")
LEGIBLEPenultimateDOA <- filter(ALLLDOA, LEGIBLENUMERIC == "1" & LEGIBLE == "Y")
LEGIBLESCOREDOA <- sum(LEGIBLEPenultimateDOA$LEGIBLENUMERIC)
TOTALLSCOREDOA <- sum(ALLLDOA$LEGIBLENUMERIC)
PercentLegibleDOA <- (LEGIBLESCOREDOA*100)/TOTALLSCOREDOA


#COMPLETE
DOACFINAL <- mutate(DOA, COMPLETENUMERIC = ifelse(DOA$COMPLETE %in% "Y", 1, ifelse(DOA$COMPLETE %in% "N", 1, 0)))
ALLCDOA <- filter(DOACFINAL, COMPLETENUMERIC == "1")
COMPLETEPenultimateDOA <- filter(ALLCDOA, COMPLETENUMERIC == "1" & COMPLETE == "Y")
COMPLETESCOREDOA <- sum(COMPLETEPenultimateDOA$COMPLETENUMERIC)
TOTALCSCOREDOA <- sum(ALLCDOA$COMPLETENUMERIC)
PercentCompleteDOA <- (COMPLETESCOREDOA*100)/TOTALCSCOREDOA


#MET
DOAMFINAL <- mutate(DOA, METNOTMETNUMERIC = ifelse(DOA$MET == "M", 1, ifelse(DOA$MET == "NM", 1, ifelse(DOA$MET == "NA", 0, 0))))
ALLMDOA <- filter(DOAMFINAL, METNOTMETNUMERIC == "1")
METPenultimateDOA <- filter(ALLMDOA, METNOTMETNUMERIC == "1" & MET == "M")
METSCOREDOA <- sum(METPenultimateDOA$METNOTMETNUMERIC)
TOTALMSCOREDOA <- sum(ALLMDOA$METNOTMETNUMERIC)
PercentMetDOA <- (METSCOREDOA*100)/TOTALMSCOREDOA


##DOS
#DOCUMENTED
DOSPenultimate <- dt %>% filter(SNN == 1.1 | SNN == 1.2 | SNN == 1.4 | SNN== 2.1 | SNN == 2.2 | SNN == 3.1 | SNN == 3.2 |
SNN == 4.1 | SNN == 5.2 | SNN == 5.4 | SNN == 6.1 | SNN == 7.1 | SNN == 7.3 |  SNN == 8.1) %>% filter(DEPT == "DOS")
DOS <- select(DOSPenultimate, "DOCUMENTED" : "MET")

DOSDFINAL <- mutate(DOS, DOCUMENTEDNUMERIC = ifelse(DOS$DOCUMENTED %in% "D", 1, ifelse(DOS$DOCUMENTED %in% "ND", 1, 0)))
ALLDDOS <- filter(DOSDFINAL, DOCUMENTEDNUMERIC == "1")
DOCUMENTEDPenultimateDOS <- filter(ALLDDOS, DOCUMENTEDNUMERIC == "1" & DOCUMENTED == "D")
DOCUMENTEDSCOREDOS <- sum(DOCUMENTEDPenultimateDOS$DOCUMENTEDNUMERIC)
TOTALDSCOREDOS <- sum(ALLDDOS$DOCUMENTEDNUMERIC)
PercentDocumentedDOS <- (DOCUMENTEDSCOREDOS*100)/TOTALDSCOREDOS


#TIMELY
DOSTFINAL <- mutate(DOS, TIMELYNUMERIC = ifelse(DOS$TIMELY %in% "Y", 1, ifelse(DOS$TIMELY %in% "N", 1, 0)))
ALLTDOS <- filter(DOSTFINAL, TIMELYNUMERIC == "1")
TIMELYPenultimateDOS <- filter(ALLTDOS, TIMELYNUMERIC == "1" & TIMELY == "Y")
TIMELYSCOREDOS <- sum(TIMELYPenultimateDOS$TIMELYNUMERIC)
TOTALTSCOREDOS <- sum(ALLTDOS$TIMELYNUMERIC)
PercentTimelyDOS <- (TIMELYSCOREDOS*100)/TOTALTSCOREDOS


#LEGIBLE
DOSLFINAL <- mutate(DOS, LEGIBLENUMERIC = ifelse(DOS$LEGIBLE %in% "Y", 1, ifelse(DOS$LEGIBLE %in% "N", 1, 0)))
ALLLDOS <- filter(DOSLFINAL, LEGIBLENUMERIC == "1")
LEGIBLEPenultimateDOS <- filter(ALLLDOS, LEGIBLENUMERIC == "1" & LEGIBLE == "Y")
LEGIBLESCOREDOS <- sum(LEGIBLEPenultimateDOS$LEGIBLENUMERIC)
TOTALLSCOREDOS <- sum(ALLLDOS$LEGIBLENUMERIC)
PercentLegibleDOS <- (LEGIBLESCOREDOS*100)/TOTALLSCOREDOS


#COMPLETE
DOSCFINAL <- mutate(DOS, COMPLETENUMERIC = ifelse(DOS$COMPLETE %in% "Y", 1, ifelse(DOS$COMPLETE %in% "N", 1, 0)))
ALLCDOS <- filter(DOSCFINAL, COMPLETENUMERIC == "1")
COMPLETEPenultimateDOS <- filter(ALLCDOS, COMPLETENUMERIC == "1" & COMPLETE == "Y")
COMPLETESCOREDOS <- sum(COMPLETEPenultimateDOS$COMPLETENUMERIC)
TOTALCSCOREDOS <- sum(ALLCDOS$COMPLETENUMERIC)
PercentCompleteDOS <- (COMPLETESCOREDOS*100)/TOTALCSCOREDOS


#MET
DOSMFINAL <- mutate(DOS, METNUMERIC = ifelse(DOS$MET %in% "M", 1, ifelse(DOS$MET %in% "NM", 1, 0)))
ALLMDOS <- filter(DOSMFINAL, METNUMERIC == "1")
METPenultimateDOS <- filter(ALLMDOS, METNUMERIC == "1" & MET == "M")
METSCOREDOS <- sum(METPenultimateDOS$METNUMERIC)
TOTALMSCOREDOS <- sum(ALLMDOS$METNUMERIC)
PercentMetDOS <- (METSCOREDOS*100)/TOTALMSCOREDOS


##DOG
#DOCUMENTED
DOGPenultimate <- dt %>% filter(SNN == 1.1 | SNN == 1.2 | SNN == 1.4 | SNN== 2.1 | SNN == 2.2 | SNN == 3.1 | SNN == 3.2 |
                                  SNN == 4.1 | SNN == 5.2 | SNN == 5.4 | SNN == 6.1 | SNN == 7.1 | SNN == 7.3 |  SNN == 8.1) %>% filter(DEPT == "DOG")
DOG <- select(DOGPenultimate, "DOCUMENTED" : "MET")

DOGDFINAL <- mutate(DOG, DOCUMENTEDNUMERIC = ifelse(DOG$DOCUMENTED %in% "D", 1, ifelse(DOG$DOCUMENTED %in% "ND", 1, 0)))
ALLDDOG <- filter(DOGDFINAL, DOCUMENTEDNUMERIC == "1")
DOCUMENTEDPenultimateDOG <- filter(ALLDDOG, DOCUMENTEDNUMERIC == "1" & DOCUMENTED == "D")
DOCUMENTEDSCOREDOG <- sum(DOCUMENTEDPenultimateDOG$DOCUMENTEDNUMERIC)
TOTALDSCOREDOG <- sum(ALLDDOG$DOCUMENTEDNUMERIC)
PercentDocumentedDOG <- (DOCUMENTEDSCOREDOG*100)/TOTALDSCOREDOG


#TIMELY
DOGTFINAL <- mutate(DOG, TIMELYNUMERIC = ifelse(DOG$TIMELY %in% "Y", 1, ifelse(DOG$TIMELY %in% "N", 1, 0)))
ALLTDOG <- filter(DOGTFINAL, TIMELYNUMERIC == "1")
TIMELYPenultimateDOG <- filter(ALLTDOG, TIMELYNUMERIC == "1" & TIMELY == "Y")
TIMELYSCOREDOG <- sum(TIMELYPenultimateDOG$TIMELYNUMERIC)
TOTALTSCOREDOG <- sum(ALLTDOG$TIMELYNUMERIC)
PercentTimelyDOG <- (TIMELYSCOREDOG*100)/TOTALTSCOREDOG


#LEGIBLE
DOGLFINAL <- mutate(DOG, LEGIBLENUMERIC = ifelse(DOG$LEGIBLE %in% "Y", 1, ifelse(DOG$LEGIBLE %in% "N", 1, 0)))
ALLLDOG <- filter(DOGLFINAL, LEGIBLENUMERIC == "1")
LEGIBLEPenultimateDOG <- filter(ALLLDOG, LEGIBLENUMERIC == "1" & LEGIBLE == "Y")
LEGIBLESCOREDOG <- sum(LEGIBLEPenultimateDOG$LEGIBLENUMERIC)
TOTALLSCOREDOG <- sum(ALLLDOG$LEGIBLENUMERIC)
PercentLegibleDOG <- (LEGIBLESCOREDOG*100)/TOTALLSCOREDOG



#COMPLETE
DOGCFINAL <- mutate(DOG, COMPLETENUMERIC = ifelse(DOG$COMPLETE %in% "Y", 1, ifelse(DOG$COMPLETE %in% "N", 1, 0)))
ALLCDOG <- filter(DOGCFINAL, COMPLETENUMERIC == "1")
COMPLETEPenultimateDOG <- filter(ALLCDOG, COMPLETENUMERIC == "1" & COMPLETE == "Y")
COMPLETESCOREDOG <- sum(COMPLETEPenultimateDOG$COMPLETENUMERIC)
TOTALCSCOREDOG <- sum(ALLCDOG$COMPLETENUMERIC)
PercentCompleteDOG <- (COMPLETESCOREDOG*100)/TOTALCSCOREDOG


#MET
DOGMFINAL <- mutate(DOG, METNUMERIC = ifelse(DOG$MET %in% "M", 1, ifelse(DOG$MET %in% "NM", 1, 0)))
ALLMDOG <- filter(DOGMFINAL, METNUMERIC == "1")
METPenultimateDOG <- filter(ALLMDOG, METNUMERIC == "1" & MET == "M")
METSCOREDOG <- sum(METPenultimateDOG$METNUMERIC)
TOTALMSCOREDOG <- sum(ALLMDOG$METNUMERIC)
PercentMetDOG <- (METSCOREDOG*100)/TOTALMSCOREDOG


##DOM
#DOCUMENTED
DOMPenultimate <- dt %>% filter(SNN == 1.1 | SNN == 1.2 | SNN == 1.4 | SNN== 2.1 | SNN == 2.2 | SNN == 3.1 | SNN == 3.2 |
                                  SNN == 4.1 | SNN == 5.2 | SNN == 5.4 | SNN == 6.1 | SNN == 7.1 | SNN == 7.3 |  SNN == 8.1) %>% filter(DEPT == "DOM")
DOM <- select(DOMPenultimate, "DOCUMENTED" : "MET")

DOMDFINAL <- mutate(DOM, DOCUMENTEDNUMERIC = ifelse(DOM$DOCUMENTED %in% "D", 1, ifelse(DOM$DOCUMENTED %in% "ND", 1, 0)))
ALLDDOM <- filter(DOMDFINAL, DOCUMENTEDNUMERIC == "1")
DOCUMENTEDPenultimateDOM <- filter(ALLDDOM, DOCUMENTEDNUMERIC == "1" & DOCUMENTED == "D")
DOCUMENTEDSCOREDOM <- sum(DOCUMENTEDPenultimateDOM$DOCUMENTEDNUMERIC)
TOTALDSCOREDOM <- sum(ALLDDOM$DOCUMENTEDNUMERIC)
PercentDocumentedDOM <- (DOCUMENTEDSCOREDOM*100)/TOTALDSCOREDOM


#TIMELY
DOMTFINAL <- mutate(DOM, TIMELYNUMERIC = ifelse(DOM$TIMELY %in% "Y", 1, ifelse(DOM$TIMELY %in% "N", 1, 0)))
ALLTDOM <- filter(DOMTFINAL, TIMELYNUMERIC == "1")
TIMELYPenultimateDOM <- filter(ALLTDOM, TIMELYNUMERIC == "1" & TIMELY == "Y")
TIMELYSCOREDOM <- sum(TIMELYPenultimateDOM$TIMELYNUMERIC)
TOTALTSCOREDOM <- sum(ALLTDOM$TIMELYNUMERIC)
PercentTimelyDOM <- (TIMELYSCOREDOM*100)/TOTALTSCOREDOM


#LEGIBLE
DOMLFINAL <- mutate(DOM, LEGIBLENUMERIC = ifelse(DOM$LEGIBLE %in% "Y", 1, ifelse(DOM$LEGIBLE %in% "N", 1, 0)))
ALLLDOM <- filter(DOMLFINAL, LEGIBLENUMERIC == "1")
LEGIBLEPenultimateDOM <- filter(ALLLDOM, LEGIBLENUMERIC == "1" & LEGIBLE == "Y")
LEGIBLESCOREDOM <- sum(LEGIBLEPenultimateDOM$LEGIBLENUMERIC)
TOTALLSCOREDOM <- sum(ALLLDOM$LEGIBLENUMERIC)
PercentLegibleDOM <- (LEGIBLESCOREDOM*100)/TOTALLSCOREDOM



#COMPLETE
DOMCFINAL <- mutate(DOM, COMPLETENUMERIC = ifelse(DOM$COMPLETE %in% "Y", 1, ifelse(DOM$COMPLETE %in% "N", 1, 0)))
ALLCDOM <- filter(DOMCFINAL, COMPLETENUMERIC == "1")
COMPLETEPenultimateDOM <- filter(ALLCDOM, COMPLETENUMERIC == "1" & COMPLETE == "Y")
COMPLETESCOREDOM <- sum(COMPLETEPenultimateDOM$COMPLETENUMERIC)
TOTALCSCOREDOM <- sum(ALLCDOM$COMPLETENUMERIC)
PercentCompleteDOM <- (COMPLETESCOREDOM*100)/TOTALCSCOREDOM


#MET
DOMMFINAL <- mutate(DOM, METNUMERIC = ifelse(DOM$MET %in% "M", 1, ifelse(DOM$MET %in% "NM", 1, 0)))
ALLMDOM <- filter(DOMMFINAL, METNUMERIC == "1")
METPenultimateDOM <- filter(ALLMDOM, METNUMERIC == "1" & MET == "M")
METSCOREDOM <- sum(METPenultimateDOM$METNUMERIC)
TOTALMSCOREDOM <- sum(ALLMDOM$METNUMERIC)
PercentMetDOM <- (METSCOREDOM*100)/TOTALMSCOREDOM


##DOP
#DOCUMENTED
DOPPenultimate <- dt %>% filter(SNN == 1.1 | SNN == 1.2 | SNN == 1.4 | SNN== 2.1 | SNN == 2.2 | SNN == 3.1 | SNN == 3.2 |
                                  SNN == 4.1 | SNN == 5.2 | SNN == 5.4 | SNN == 6.1 | SNN == 7.1 | SNN == 7.3 |  SNN == 8.1) %>% filter(DEPT == "DOP")
DOP <- select(DOPPenultimate, "DOCUMENTED" : "MET")

DOPDFINAL <- mutate(DOP, DOCUMENTEDNUMERIC = ifelse(DOP$DOCUMENTED %in% "D", 1, ifelse(DOP$DOCUMENTED %in% "ND", 1, 0)))
ALLDDOP <- filter(DOPDFINAL, DOCUMENTEDNUMERIC == "1")
DOCUMENTEDPenultimateDOP <- filter(ALLDDOP, DOCUMENTEDNUMERIC == "1" & DOCUMENTED == "D")
DOCUMENTEDSCOREDOP <- sum(DOCUMENTEDPenultimateDOP$DOCUMENTEDNUMERIC)
TOTALDSCOREDOP <- sum(ALLDDOP$DOCUMENTEDNUMERIC)
PercentDocumentedDOP <- (DOCUMENTEDSCOREDOP*100)/TOTALDSCOREDOP


#TIMELY
DOPTFINAL <- mutate(DOP, TIMELYNUMERIC = ifelse(DOP$TIMELY %in% "Y", 1, ifelse(DOP$TIMELY %in% "N", 1, 0)))
ALLTDOP <- filter(DOPTFINAL, TIMELYNUMERIC == "1")
TIMELYPenultimateDOP <- filter(ALLTDOP, TIMELYNUMERIC == "1" & TIMELY == "Y")
TIMELYSCOREDOP <- sum(TIMELYPenultimateDOP$TIMELYNUMERIC)
TOTALTSCOREDOP <- sum(ALLTDOP$TIMELYNUMERIC)
PercentTimelyDOP <- (TIMELYSCOREDOP*100)/TOTALTSCOREDOP


#LEGIBLE
DOPLFINAL <- mutate(DOP, LEGIBLENUMERIC = ifelse(DOP$LEGIBLE %in% "Y", 1, ifelse(DOP$LEGIBLE %in% "N", 1, 0)))
ALLLDOP <- filter(DOPLFINAL, LEGIBLENUMERIC == "1")
LEGIBLEPenultimateDOP <- filter(ALLLDOP, LEGIBLENUMERIC == "1" & LEGIBLE == "Y")
LEGIBLESCOREDOP <- sum(LEGIBLEPenultimateDOP$LEGIBLENUMERIC)
TOTALLSCOREDOP <- sum(ALLLDOP$LEGIBLENUMERIC)
PercentLegibleDOP <- (LEGIBLESCOREDOP*100)/TOTALLSCOREDOP



#COMPLETE
DOPCFINAL <- mutate(DOP, COMPLETENUMERIC = ifelse(DOP$COMPLETE %in% "Y", 1, ifelse(DOP$COMPLETE %in% "N", 1, 0)))
ALLCDOP <- filter(DOPCFINAL, COMPLETENUMERIC == "1")
COMPLETEPenultimateDOP <- filter(ALLCDOP, COMPLETENUMERIC == "1" & COMPLETE == "Y")
COMPLETESCOREDOP <- sum(COMPLETEPenultimateDOP$COMPLETENUMERIC)
TOTALCSCOREDOP <- sum(ALLCDOP$COMPLETENUMERIC)
PercentCompleteDOP <- (COMPLETESCOREDOP*100)/TOTALCSCOREDOP


#MET
DOPMFINAL <- mutate(DOP, METNUMERIC = ifelse(DOP$MET %in% "M", 1, ifelse(DOP$MET %in% "NM", 1, 0)))
ALLMDOP <- filter(DOPMFINAL, METNUMERIC == "1")
METPenultimateDOP <- filter(ALLMDOP, METNUMERIC == "1" & MET == "M")
METSCOREDOP <- sum(METPenultimateDOP$METNUMERIC)
TOTALMSCOREDOP <- sum(ALLMDOP$METNUMERIC)
PercentMetDOP <- (METSCOREDOP*100)/TOTALMSCOREDOP


##DON
#DOCUMENTED
DONPenultimate <- dt %>% filter(SNN == 1.5 | SNN == 2.1 | SNN == 3.1 | SNN== 3.2) %>% filter(DEPT == "DON")
DON <- select(DONPenultimate, "DOCUMENTED" : "MET")

DONDFINAL <- mutate(DON, DOCUMENTEDNUMERIC = ifelse(DON$DOCUMENTED %in% "D", 1, ifelse(DON$DOCUMENTED %in% "ND", 1, 0)))
ALLDDON <- filter(DONDFINAL, DOCUMENTEDNUMERIC == "1")
DOCUMENTEDPenultimateDON <- filter(ALLDDON, DOCUMENTEDNUMERIC == "1" & DOCUMENTED == "D")
DOCUMENTEDSCOREDON <- sum(DOCUMENTEDPenultimateDON$DOCUMENTEDNUMERIC)
TOTALDSCOREDON <- sum(ALLDDON$DOCUMENTEDNUMERIC)
PercentDocumentedDON <- (DOCUMENTEDSCOREDON*100)/TOTALDSCOREDON


#TIMELY
DONTFINAL <- mutate(DON, TIMELYNUMERIC = ifelse(DON$TIMELY %in% "Y", 1, ifelse(DON$TIMELY %in% "N", 1, 0)))
ALLTDON <- filter(DONTFINAL, TIMELYNUMERIC == "1")
TIMELYPenultimateDON <- filter(ALLTDON, TIMELYNUMERIC == "1" & TIMELY == "Y")
TIMELYSCOREDON <- sum(TIMELYPenultimateDON$TIMELYNUMERIC)
TOTALTSCOREDON <- sum(ALLTDON$TIMELYNUMERIC)
PercentTimelyDON <- (TIMELYSCOREDON*100)/TOTALTSCOREDON


#LEGIBLE
DONLFINAL <- mutate(DON, LEGIBLENUMERIC = ifelse(DON$LEGIBLE %in% "Y", 1, ifelse(DON$LEGIBLE %in% "N", 1, 0)))
ALLLDON <- filter(DONLFINAL, LEGIBLENUMERIC == "1")
LEGIBLEPenultimateDON <- filter(ALLLDON, LEGIBLENUMERIC == "1" & LEGIBLE == "Y")
LEGIBLESCOREDON <- sum(LEGIBLEPenultimateDON$LEGIBLENUMERIC)
TOTALLSCOREDON <- sum(ALLLDON$LEGIBLENUMERIC)
PercentLegibleDON <- (LEGIBLESCOREDON*100)/TOTALLSCOREDON



#COMPLETE
DONCFINAL <- mutate(DON, COMPLETENUMERIC = ifelse(DON$COMPLETE %in% "Y", 1, ifelse(DON$COMPLETE %in% "N", 1, 0)))
ALLCDON <- filter(DONCFINAL, COMPLETENUMERIC == "1")
COMPLETEPenultimateDON <- filter(ALLCDON, COMPLETENUMERIC == "1" & COMPLETE == "Y")
COMPLETESCOREDON <- sum(COMPLETEPenultimateDON$COMPLETENUMERIC)
TOTALCSCOREDON <- sum(ALLCDON$COMPLETENUMERIC)
PercentCompleteDON <- (COMPLETESCOREDON*100)/TOTALCSCOREDON


#MET
DONMFINAL <- mutate(DON, METNUMERIC = ifelse(DON$MET %in% "M", 1, ifelse(DON$MET %in% "NM", 1, 0)))
ALLMDON <- filter(DONMFINAL, METNUMERIC == "1")
METPenultimateDON <- filter(ALLMDON, METNUMERIC == "1" & MET == "M")
METSCOREDON <- sum(METPenultimateDON$METNUMERIC)
TOTALMSCOREDON <- sum(ALLMDON$METNUMERIC)
PercentMetDON <- (METSCOREDON*100)/TOTALMSCOREDON


##RM
#DOCUMENTED
RMPenultimate <- dt %>% filter(SNN == 1.4 | SNN == 1.6 | SNN == 1.7 | SNN== 2.1 | SNN == 3.1) %>% filter(DEPT == "RM")
RM <- select(RMPenultimate, "DOCUMENTED" : "MET")

RMDFINAL <- mutate(RM, DOCUMENTEDNUMERIC = ifelse(RM$DOCUMENTED %in% "D", 1, ifelse(RM$DOCUMENTED %in% "ND", 1, 0)))
ALLDRM <- filter(RMDFINAL, DOCUMENTEDNUMERIC == "1")
DOCUMENTEDPenultimateRM <- filter(ALLDRM, DOCUMENTEDNUMERIC == "1" & DOCUMENTED == "D")
DOCUMENTEDSCORERM <- sum(DOCUMENTEDPenultimateRM$DOCUMENTEDNUMERIC)
TOTALDSCORERM <- sum(ALLDRM$DOCUMENTEDNUMERIC)
PercentDocumentedRM <- (DOCUMENTEDSCORERM*100)/TOTALDSCORERM


#TIMELY
RMTFINAL <- mutate(RM, TIMELYNUMERIC = ifelse(RM$TIMELY %in% "Y", 1, ifelse(RM$TIMELY %in% "N", 1, 0)))
ALLTRM <- filter(RMTFINAL, TIMELYNUMERIC == "1")
TIMELYPenultimateRM <- filter(ALLTRM, TIMELYNUMERIC == "1" & TIMELY == "Y")
TIMELYSCORERM <- sum(TIMELYPenultimateRM$TIMELYNUMERIC)
TOTALTSCORERM <- sum(ALLTRM$TIMELYNUMERIC)
PercentTimelyRM <- (TIMELYSCORERM*100)/TOTALTSCORERM


#LEGIBLE
RMLFINAL <- mutate(RM, LEGIBLENUMERIC = ifelse(RM$LEGIBLE %in% "Y", 1, ifelse(RM$LEGIBLE %in% "N", 1, 0)))
ALLLRM <- filter(RMLFINAL, LEGIBLENUMERIC == "1")
LEGIBLEPenultimateRM <- filter(ALLLRM, LEGIBLENUMERIC == "1" & LEGIBLE == "Y")
LEGIBLESCORERM <- sum(LEGIBLEPenultimateRM$LEGIBLENUMERIC)
TOTALLSCORERM <- sum(ALLLRM$LEGIBLENUMERIC)
PercentLegibleRM <- (LEGIBLESCORERM*100)/TOTALLSCORERM



#COMPLETE
RMCFINAL <- mutate(RM, COMPLETENUMERIC = ifelse(RM$COMPLETE %in% "Y", 1, ifelse(RM$COMPLETE %in% "N", 1, 0)))
ALLCRM <- filter(RMCFINAL, COMPLETENUMERIC == "1")
COMPLETEPenultimateRM <- filter(ALLCRM, COMPLETENUMERIC == "1" & COMPLETE == "Y")
COMPLETESCORERM <- sum(COMPLETEPenultimateRM$COMPLETENUMERIC)
TOTALCSCORERM <- sum(ALLCRM$COMPLETENUMERIC)
PercentCompleteRM <- (COMPLETESCORERM*100)/TOTALCSCORERM


#MET
RMMFINAL <- mutate(RM, METNUMERIC = ifelse(RM$MET %in% "M", 1, ifelse(RM$MET %in% "NM", 1, 0)))
ALLMRM <- filter(RMMFINAL, METNUMERIC == "1")
METPenultimateRM <- filter(ALLMRM, METNUMERIC == "1" & MET == "M")
METSCORERM <- sum(METPenultimateRM$METNUMERIC)
TOTALMSCORERM <- sum(ALLMRM$METNUMERIC)
PercentMetRM <- (METSCORERM*100)/TOTALMSCORERM


##DEPARTMENTAL SCORES
#Department of Anaesthesia Scores:
PercentDocumentedDOA
PercentTimelyDOA
PercentLegibleDOA
PercentCompleteDOA
PercentMetDOA

#Department of Surgery Scores:
PercentDocumentedDOS
PercentTimelyDOS
PercentLegibleDOS
PercentCompleteDOS
PercentMetDOS

#Department of Obstetrics & Gynaecology Scores:
PercentDocumentedDOG
PercentTimelyDOG
PercentLegibleDOG
PercentCompleteDOG
PercentMetDOG

#Department of Medicine Scores:
PercentDocumentedDOM
PercentTimelyDOM
PercentLegibleDOM
PercentCompleteDOM
PercentMetDOM

#Department of Paediatrics Scores:
PercentDocumentedDOP
PercentTimelyDOP
PercentLegibleDOP
PercentCompleteDOP
PercentMetDOP

#Department of Nutrition Scores:
PercentDocumentedDON
PercentTimelyDON
PercentLegibleDON
PercentCompleteDON
PercentMetDON

#Department of Physiotherapy:
PercentDocumentedRM
PercentTimelyRM
PercentLegibleRM
PercentCompleteRM
PercentMetRM